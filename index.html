<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Agent PhÃ²ng CÆ¡ Äiá»‡n</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 800px;
            min-height: 600px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.2em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .status-bar {
            background: linear-gradient(90deg, #4CAF50, #45a049);
            color: white;
            padding: 12px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 500;
        }

        .upload-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            border: 2px dashed #dee2e6;
            transition: all 0.3s ease;
        }

        .upload-section:hover {
            border-color: #007bff;
            background: #f0f8ff;
        }

        .upload-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
            transition: background 0.3s;
        }

        .upload-button:hover {
            background: #0056b3;
        }

        .chat-container {
            height: 400px;
            border: 2px solid #e9ecef;
            border-radius: 15px;
            overflow: hidden;
            background: white;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: linear-gradient(to bottom, #fafafa, #ffffff);
        }

        .message {
            margin-bottom: 15px;
            padding: 12px 16px;
            border-radius: 15px;
            max-width: 80%;
            word-wrap: break-word;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .user-message {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            align-self: flex-end;
            margin-left: auto;
        }

        .ai-message {
            background: linear-gradient(135deg, #e9ecef, #f8f9fa);
            color: #2c3e50;
            border-left: 4px solid #007bff;
        }

        .error-message {
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
            border-left: 4px solid #a71e2a;
        }

        .chat-input-container {
            padding: 20px;
            border-top: 1px solid #e9ecef;
            background: #f8f9fa;
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.3s;
        }

        .chat-input:focus {
            border-color: #007bff;
        }

        .send-button {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: transform 0.2s;
        }

        .send-button:hover {
            transform: scale(1.05);
        }

        .send-button:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #007bff;
            font-style: italic;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .document-count {
            background: #17a2b8;
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 14px;
            display: inline-block;
            margin-top: 10px;
        }

        .language-selector {
            margin-bottom: 20px;
            text-align: center;
        }

        .language-selector select {
            padding: 8px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 16px;
            background: white;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .chat-container {
                height: 350px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                ğŸ¤– AI Agent PhÃ²ng CÆ¡ Äiá»‡n
            </h1>
            <p>Há»‡ thá»‘ng há»— trá»£ ká»¹ thuáº­t thÃ´ng minh cho nhÃ¢n viÃªn</p>
        </div>

        <div class="status-bar" id="statusBar">
            âœ… Há»‡ thá»‘ng Ä‘Ã£ sáºµn sÃ ng - Káº¿t ná»‘i Google Drive thÃ nh cÃ´ng
        </div>

        <div class="language-selector">
            <label for="languageSelect">ğŸŒ NgÃ´n ngá»¯: </label>
            <select id="languageSelect">
                <option value="vi">Tiáº¿ng Viá»‡t</option>
                <option value="en">English</option>
                <option value="zh">ä¸­æ–‡</option>
                <option value="ja">æ—¥æœ¬èª</option>
            </select>
        </div>

        <div class="upload-section">
            <h3>ğŸ“ Quáº£n lÃ½ TÃ i liá»‡u</h3>
            <p>Há»‡ thá»‘ng sáº½ tá»± Ä‘á»™ng Ä‘á»“ng bá»™ tÃ i liá»‡u tá»« Google Drive</p>
            <button class="upload-button" onclick="syncDocuments()">ğŸ”„ Äá»“ng bá»™ tÃ i liá»‡u</button>
            <button class="upload-button" onclick="showDocuments()" style="background: #28a745;">ğŸ“‹ Xem danh sÃ¡ch</button>
            <div class="document-count" id="docCount">ğŸ“Š ÄÃ£ táº£i: 0 tÃ i liá»‡u</div>
        </div>

        <div class="chat-container">
            <div class="chat-messages" id="chatMessages">
                <div class="message ai-message">
                    ğŸ‘‹ Xin chÃ o! TÃ´i lÃ  AI Assistant cá»§a phÃ²ng CÆ¡ Äiá»‡n. TÃ´i cÃ³ thá»ƒ giÃºp báº¡n tÃ¬m kiáº¿m thÃ´ng tin trong cÃ¡c tÃ i liá»‡u ká»¹ thuáº­t. HÃ£y Ä‘áº·t cÃ¢u há»i vá»:
                    <br>â€¢ Quy trÃ¬nh váº­n hÃ nh thiáº¿t bá»‹
                    <br>â€¢ HÆ°á»›ng dáº«n báº£o trÃ¬
                    <br>â€¢ ThÃ´ng sá»‘ ká»¹ thuáº­t
                    <br>â€¢ Xá»­ lÃ½ sá»± cá»‘
                    <br><br>ğŸ’¡ <strong>VÃ­ dá»¥:</strong> "LÃ m tháº¿ nÃ o Ä‘á»ƒ báº£o trÃ¬ mÃ¡y nÃ©n khÃ­?" hoáº·c "ThÃ´ng sá»‘ Ä‘iá»‡n Ã¡p váº­n hÃ nh cá»§a mÃ¡y bÆ¡m lÃ  gÃ¬?"
                </div>
            </div>
            <div class="chat-input-container">
                <input type="text" class="chat-input" id="chatInput" placeholder="Nháº­p cÃ¢u há»i cá»§a báº¡n..." onkeypress="handleKeyPress(event)">
                <button class="send-button" id="sendButton" onclick="sendMessage()">ğŸ“¤ Gá»­i</button>
            </div>
        </div>
    </div>

    <script>
        // Cáº¥u hÃ¬nh há»‡ thá»‘ng
        const CONFIG = {
            openaiApiKey: 'YOUR_OPENAI_API_KEY', // Thay tháº¿ báº±ng API key cá»§a báº¡n
            googleDriveFolder: 'https://drive.google.com/drive/folders/1uIrX9anqJGZUZttJHWQJR3iTIkNkWnn1',
            maxTokens: 2000,
            temperature: 0.1
        };

        // Biáº¿n global
        let documents = [];
        let documentEmbeddings = [];
        let isProcessing = false;
        let currentLanguage = 'vi';

        // Khá»Ÿi táº¡o há»‡ thá»‘ng khi trang Ä‘Æ°á»£c táº£i
        window.addEventListener('load', function() {
            initializeSystem();
            updateDocumentCount();
        });

        async function initializeSystem() {
            try {
                updateStatus('ğŸ”„ Äang khá»Ÿi táº¡o há»‡ thá»‘ng...', '#ffc107');
                
                // MÃ´ phá»ng viá»‡c táº£i tÃ i liá»‡u tá»« Google Drive
                await simulateDocumentLoad();
                
                updateStatus('âœ… Há»‡ thá»‘ng Ä‘Ã£ sáºµn sÃ ng - Káº¿t ná»‘i Google Drive thÃ nh cÃ´ng', '#28a745');
            } catch (error) {
                updateStatus('âŒ Lá»—i khá»Ÿi táº¡o: ' + error.message, '#dc3545');
            }
        }

        async function simulateDocumentLoad() {
            // MÃ´ phá»ng dá»¯ liá»‡u tÃ i liá»‡u máº«u
            const sampleDocuments = [
                {
                    name: "HÆ°á»›ng dáº«n báº£o trÃ¬ mÃ¡y nÃ©n khÃ­.pdf",
                    content: "Quy trÃ¬nh báº£o trÃ¬ mÃ¡y nÃ©n khÃ­: 1. Kiá»ƒm tra Ã¡p suáº¥t hÃ ng ngÃ y 2. Thay dáº§u má»—i 500 giá» váº­n hÃ nh 3. Vá»‡ sinh lá»c khÃ­ hÃ ng tuáº§n 4. Kiá»ƒm tra van an toÃ n Ä‘á»‹nh ká»³",
                    type: "maintenance",
                    language: "vi"
                },
                {
                    name: "ThÃ´ng sá»‘ ká»¹ thuáº­t mÃ¡y bÆ¡m nÆ°á»›c.docx",
                    content: "MÃ¡y bÆ¡m nÆ°á»›c ly tÃ¢m: CÃ´ng suáº¥t 5.5kW, Ä‘iá»‡n Ã¡p 380V, lÆ°u lÆ°á»£ng 50m3/h, cá»™t Ã¡p 32m, tá»‘c Ä‘á»™ 2900 vÃ²ng/phÃºt",
                    type: "specification",
                    language: "vi"
                },
                {
                    name: "Quy trÃ¬nh xá»­ lÃ½ sá»± cá»‘ Ä‘iá»‡n.pdf",
                    content: "Khi gáº·p sá»± cá»‘ máº¥t Ä‘iá»‡n: 1. Kiá»ƒm tra cáº§u dao tá»•ng 2. Kiá»ƒm tra cÃ¡c aptomat 3. Äo Ä‘iá»‡n Ã¡p Ä‘áº§u vÃ o 4. LiÃªn há»‡ ká»¹ sÆ° Ä‘iá»‡n náº¿u cáº§n thiáº¿t",
                    type: "troubleshooting",
                    language: "vi"
                }
            ];

            documents = sampleDocuments;
            
            // Táº¡o embeddings cho tÃ i liá»‡u
            for (let doc of documents) {
                const embedding = await createEmbedding(doc.content);
                documentEmbeddings.push({
                    document: doc,
                    embedding: embedding
                });
            }
            
            updateDocumentCount();
        }

        async function createEmbedding(text) {
            // MÃ´ phá»ng embedding Ä‘Æ¡n giáº£n (trong thá»±c táº¿ sáº½ dÃ¹ng OpenAI API)
            return Array.from({length: 1536}, () => Math.random());
        }

        async function syncDocuments() {
            if (isProcessing) return;
            
            isProcessing = true;
            updateStatus('ğŸ”„ Äang Ä‘á»“ng bá»™ tÃ i liá»‡u tá»« Google Drive...', '#ffc107');
            
            try {
                // MÃ´ phá»ng quÃ¡ trÃ¬nh Ä‘á»“ng bá»™
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // ThÃªm má»™t tÃ i liá»‡u má»›i Ä‘á»ƒ mÃ´ phá»ng
                const newDoc = {
                    name: "HÆ°á»›ng dáº«n váº­n hÃ nh há»‡ thá»‘ng HVAC.pdf",
                    content: "Há»‡ thá»‘ng Ä‘iá»u hÃ²a khÃ´ng khÃ­: Nhiá»‡t Ä‘á»™ váº­n hÃ nh 22-25Â°C, Ä‘á»™ áº©m 50-60%, Ã¡p suáº¥t khÃ´ng khÃ­ dÆ°Æ¡ng, thay lá»c khÃ´ng khÃ­ 3 thÃ¡ng má»™t láº§n",
                    type: "operation",
                    language: "vi"
                };
                
                documents.push(newDoc);
                const embedding = await createEmbedding(newDoc.content);
                documentEmbeddings.push({
                    document: newDoc,
                    embedding: embedding
                });
                
                updateDocumentCount();
                updateStatus('âœ… Äá»“ng bá»™ thÃ nh cÃ´ng - ÄÃ£ cáº­p nháº­t tÃ i liá»‡u má»›i', '#28a745');
                
            } catch (error) {
                updateStatus('âŒ Lá»—i Ä‘á»“ng bá»™: ' + error.message, '#dc3545');
            } finally {
                isProcessing = false;
            }
        }

        function showDocuments() {
            const docList = documents.map(doc => `ğŸ“„ ${doc.name}`).join('\n');
            addMessage(`ğŸ“‹ Danh sÃ¡ch tÃ i liá»‡u hiá»‡n cÃ³:\n\n${docList}`, 'ai-message');
        }

        function updateDocumentCount() {
            document.getElementById('docCount').textContent = `ğŸ“Š ÄÃ£ táº£i: ${documents.length} tÃ i liá»‡u`;
        }

        function updateStatus(message, color) {
            const statusBar = document.getElementById('statusBar');
            statusBar.textContent = message;
            statusBar.style.background = color;
        }

        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message || isProcessing) return;
            
            input.value = '';
            addMessage(message, 'user-message');
            
            isProcessing = true;
            const sendButton = document.getElementById('sendButton');
            sendButton.disabled = true;
            sendButton.textContent = 'â³ Äang xá»­ lÃ½...';
            
            // Hiá»ƒn thá»‹ loading
            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'message ai-message loading';
            loadingDiv.innerHTML = '<div class="spinner"></div> Äang tÃ¬m kiáº¿m thÃ´ng tin...';
            document.getElementById('chatMessages').appendChild(loadingDiv);
            scrollToBottom();
            
            try {
                const response = await processQuery(message);
                loadingDiv.remove();
                addMessage(response, 'ai-message');
            } catch (error) {
                loadingDiv.remove();
                addMessage('âŒ Xin lá»—i, Ä‘Ã£ xáº£y ra lá»—i khi xá»­ lÃ½ cÃ¢u há»i cá»§a báº¡n: ' + error.message, 'error-message');
            } finally {
                isProcessing = false;
                sendButton.disabled = false;
                sendButton.textContent = 'ğŸ“¤ Gá»­i';
            }
        }

        async function processQuery(query) {
            try {
                // TÃ¬m kiáº¿m tÃ i liá»‡u liÃªn quan
                const relevantDocs = await searchRelevantDocuments(query);
                
                if (relevantDocs.length === 0) {
                    return `âŒ KhÃ´ng tÃ¬m tháº¥y thÃ´ng tin liÃªn quan Ä‘áº¿n cÃ¢u há»i: "${query}"\n\nğŸ’¡ Gá»£i Ã½:\nâ€¢ Thá»­ Ä‘áº·t cÃ¢u há»i khÃ¡c cÃ¡ch\nâ€¢ Kiá»ƒm tra xem tÃ i liá»‡u cÃ³ trong há»‡ thá»‘ng khÃ´ng\nâ€¢ LiÃªn há»‡ bá»™ pháº­n ká»¹ thuáº­t náº¿u cáº§n há»— trá»£ thÃªm`;
                }
                
                // Táº¡o context tá»« cÃ¡c tÃ i liá»‡u liÃªn quan
                const context = relevantDocs.map(doc => 
                    `TÃ i liá»‡u: ${doc.document.name}\nNá»™i dung: ${doc.document.content}`
                ).join('\n\n');
                
                // Táº¡o prompt cho OpenAI
                const prompt = createPrompt(query, context, currentLanguage);
                
                // MÃ´ phá»ng pháº£n há»“i tá»« AI (trong thá»±c táº¿ sáº½ gá»i OpenAI API)
                const response = await simulateAIResponse(query, relevantDocs);
                
                return response;
                
            } catch (error) {
                throw new Error('Lá»—i xá»­ lÃ½ truy váº¥n: ' + error.message);
            }
        }

        async function searchRelevantDocuments(query) {
            // MÃ´ phá»ng tÃ¬m kiáº¿m vector
            const queryEmbedding = await createEmbedding(query);
            
            const similarities = documentEmbeddings.map(docEmb => ({
                document: docEmb.document,
                similarity: calculateSimilarity(queryEmbedding, docEmb.embedding)
            }));
            
            // Sáº¯p xáº¿p theo Ä‘á»™ tÆ°Æ¡ng tá»± vÃ  láº¥y top 3
            return similarities
                .sort((a, b) => b.similarity - a.similarity)
                .slice(0, 3)
                .filter(item => item.similarity > 0.5); // NgÆ°á»¡ng tÆ°Æ¡ng tá»± tá»‘i thiá»ƒu
        }

        function calculateSimilarity(vec1, vec2) {
            // TÃ­nh cosine similarity Ä‘Æ¡n giáº£n
            const dotProduct = vec1.reduce((sum, a, i) => sum + a * vec2[i], 0);
            const normA = Math.sqrt(vec1.reduce((sum, a) => sum + a * a, 0));
            const normB = Math.sqrt(vec2.reduce((sum, b) => sum + b * b, 0));
            return dotProduct / (normA * normB);
        }

        function createPrompt(query, context, language) {
            const prompts = {
                vi: `Báº¡n lÃ  má»™t chuyÃªn gia ká»¹ thuáº­t cÆ¡ Ä‘iá»‡n. Dá»±a vÃ o thÃ´ng tin sau Ä‘Ã¢y, hÃ£y tráº£ lá»i cÃ¢u há»i má»™t cÃ¡ch chÃ­nh xÃ¡c vÃ  chi tiáº¿t.

ThÃ´ng tin tÃ i liá»‡u:
${context}

CÃ¢u há»i: ${query}

YÃªu cáº§u:
- Chá»‰ tráº£ lá»i dá»±a trÃªn thÃ´ng tin cÃ³ trong tÃ i liá»‡u
- Náº¿u khÃ´ng cÃ³ thÃ´ng tin, hÃ£y nÃ³i rÃµ "KhÃ´ng tÃ¬m tháº¥y thÃ´ng tin"
- ÄÆ°a ra cÃ¢u tráº£ lá»i chi tiáº¿t vÃ  thá»±c táº¿
- Sá»­ dá»¥ng tiáº¿ng Viá»‡t`,
                
                en: `You are a mechanical-electrical engineering expert. Based on the following information, answer the question accurately and in detail.

Document information:
${context}

Question: ${query}

Requirements:
- Only answer based on information in the documents
- If no information is found, clearly state "Information not found"
- Provide detailed and practical answers
- Use English`,
                
                zh: `æ‚¨æ˜¯æœºç”µå·¥ç¨‹ä¸“å®¶ã€‚æ ¹æ®ä»¥ä¸‹ä¿¡æ¯ï¼Œå‡†ç¡®è¯¦ç»†åœ°å›ç­”é—®é¢˜ã€‚

æ–‡æ¡£ä¿¡æ¯ï¼š
${context}

é—®é¢˜ï¼š${query}

è¦æ±‚ï¼š
- ä»…æ ¹æ®æ–‡æ¡£ä¸­çš„ä¿¡æ¯å›ç­”
- å¦‚æœæ²¡æœ‰æ‰¾åˆ°ä¿¡æ¯ï¼Œè¯·æ˜ç¡®è¯´æ˜"æœªæ‰¾åˆ°ä¿¡æ¯"
- æä¾›è¯¦ç»†å’Œå®ç”¨çš„ç­”æ¡ˆ
- ä½¿ç”¨ä¸­æ–‡`
            };
            
            return prompts[language] || prompts.vi;
        }

        async function simulateAIResponse(query, relevantDocs) {
            // MÃ´ phá»ng pháº£n há»“i thÃ´ng minh dá»±a trÃªn tá»« khÃ³a
            const queryLower = query.toLowerCase();
            
            if (queryLower.includes('mÃ¡y nÃ©n khÃ­') || queryLower.includes('nÃ©n khÃ­')) {
                return `ğŸ”§ **ThÃ´ng tin vá» mÃ¡y nÃ©n khÃ­:**\n\nDá»±a vÃ o tÃ i liá»‡u "HÆ°á»›ng dáº«n báº£o trÃ¬ mÃ¡y nÃ©n khÃ­.pdf", tÃ´i tÃ¬m tháº¥y thÃ´ng tin sau:\n\n**Quy trÃ¬nh báº£o trÃ¬:**\nâ€¢ Kiá»ƒm tra Ã¡p suáº¥t hÃ ng ngÃ y\nâ€¢ Thay dáº§u má»—i 500 giá» váº­n hÃ nh\nâ€¢ Vá»‡ sinh lá»c khÃ­ hÃ ng tuáº§n\nâ€¢ Kiá»ƒm tra van an toÃ n Ä‘á»‹nh ká»³\n\nâš ï¸ **LÆ°u Ã½:** LuÃ´n tuÃ¢n thá»§ cÃ¡c quy trÃ¬nh an toÃ n khi lÃ m viá»‡c vá»›i thiáº¿t bá»‹ Ã¡p suáº¥t cao.`;
            }
            
            if (queryLower.includes('mÃ¡y bÆ¡m') || queryLower.includes('bÆ¡m nÆ°á»›c')) {
                return `ğŸ’§ **ThÃ´ng sá»‘ ká»¹ thuáº­t mÃ¡y bÆ¡m nÆ°á»›c:**\n\nTá»« tÃ i liá»‡u "ThÃ´ng sá»‘ ká»¹ thuáº­t mÃ¡y bÆ¡m nÆ°á»›c.docx":\n\n**ThÃ´ng sá»‘ chÃ­nh:**\nâ€¢ Loáº¡i: MÃ¡y bÆ¡m nÆ°á»›c ly tÃ¢m\nâ€¢ CÃ´ng suáº¥t: 5.5kW\nâ€¢ Äiá»‡n Ã¡p: 380V\nâ€¢ LÆ°u lÆ°á»£ng: 50mÂ³/h\nâ€¢ Cá»™t Ã¡p: 32m\nâ€¢ Tá»‘c Ä‘á»™: 2900 vÃ²ng/phÃºt\n\nğŸ“‹ **á»¨ng dá»¥ng:** PhÃ¹ há»£p cho cÃ¡c há»‡ thá»‘ng cáº¥p nÆ°á»›c cÃ´ng nghiá»‡p.`;
            }
            
            if (queryLower.includes('sá»± cá»‘') || queryLower.includes('máº¥t Ä‘iá»‡n') || queryLower.includes('Ä‘iá»‡n')) {
                return `âš¡ **Quy trÃ¬nh xá»­ lÃ½ sá»± cá»‘ Ä‘iá»‡n:**\n\nTheo tÃ i liá»‡u "Quy trÃ¬nh xá»­ lÃ½ sá»± cá»‘ Ä‘iá»‡n.pdf":\n\n**CÃ¡c bÆ°á»›c xá»­ lÃ½ khi máº¥t Ä‘iá»‡n:**\n1. âœ… Kiá»ƒm tra cáº§u dao tá»•ng\n2. âœ… Kiá»ƒm tra cÃ¡c aptomat\n3. âœ… Äo Ä‘iá»‡n Ã¡p Ä‘áº§u vÃ o\n4. âœ… LiÃªn há»‡ ká»¹ sÆ° Ä‘iá»‡n náº¿u cáº§n thiáº¿t\n\nğŸš¨ **Cáº£nh bÃ¡o:** Chá»‰ nhá»¯ng ngÆ°á»i cÃ³ chuyÃªn mÃ´n má»›i Ä‘Æ°á»£c thá»±c hiá»‡n cÃ¡c thao tÃ¡c trÃªn há»‡ thá»‘ng Ä‘iá»‡n.`;
            }
            
            if (queryLower.includes('hvac') || queryLower.includes('Ä‘iá»u hÃ²a') || queryLower.includes('khÃ´ng khÃ­')) {
                return `â„ï¸ **HÆ°á»›ng dáº«n váº­n hÃ nh há»‡ thá»‘ng HVAC:**\n\nTá»« tÃ i liá»‡u "HÆ°á»›ng dáº«n váº­n hÃ nh há»‡ thá»‘ng HVAC.pdf":\n\n**ThÃ´ng sá»‘ váº­n hÃ nh:**\nâ€¢ Nhiá»‡t Ä‘á»™: 22-25Â°C\nâ€¢ Äá»™ áº©m: 50-60%\nâ€¢ Ãp suáº¥t khÃ´ng khÃ­: DÆ°Æ¡ng Ã¡p\nâ€¢ Báº£o trÃ¬ lá»c: 3 thÃ¡ng/láº§n\n\nğŸ’¡ **Gá»£i Ã½:** Kiá»ƒm tra Ä‘á»‹nh ká»³ Ä‘á»ƒ Ä‘áº£m báº£o hiá»‡u suáº¥t tá»‘i Æ°u.`;
            }
            
            // Pháº£n há»“i máº·c Ä‘á»‹nh
            return `ğŸ“š TÃ´i Ä‘Ã£ tÃ¬m kiáº¿m trong ${documents.length} tÃ i liá»‡u cÃ³ sáºµn nhÆ°ng khÃ´ng tÃ¬m tháº¥y thÃ´ng tin cá»¥ thá»ƒ vá» cÃ¢u há»i: "${query}"\n\nğŸ’¡ **Gá»£i Ã½:**\nâ€¢ Thá»­ Ä‘áº·t cÃ¢u há»i khÃ¡c cÃ¡ch hoáº·c sá»­ dá»¥ng tá»« khÃ³a khÃ¡c\nâ€¢ Kiá»ƒm tra xem tÃ i liá»‡u liÃªn quan Ä‘Ã£ Ä‘Æ°á»£c táº£i lÃªn Google Drive chÆ°a\nâ€¢ LiÃªn há»‡ vá»›i bá»™ pháº­n ká»¹ thuáº­t Ä‘á»ƒ Ä‘Æ°á»£c há»— trá»£ thÃªm\n\nğŸ“‹ **CÃ¡c chá»§ Ä‘á» tÃ´i cÃ³ thá»ƒ há»— trá»£:**\nâ€¢ MÃ¡y nÃ©n khÃ­ vÃ  báº£o trÃ¬\nâ€¢ MÃ¡y bÆ¡m nÆ°á»›c vÃ  thÃ´ng sá»‘ ká»¹ thuáº­t\nâ€¢ Xá»­ lÃ½ sá»± cá»‘ Ä‘iá»‡n\nâ€¢ Há»‡ thá»‘ng HVAC vÃ  Ä‘iá»u hÃ²a khÃ´ng khÃ­`;
        }

        function addMessage(message, className) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${className}`;
            messageDiv.innerHTML = message.replace(/\n/g, '<br>');
            chatMessages.appendChild(messageDiv);
            scrollToBottom();
        }

        function scrollToBottom() {
            const chatMessages = document.getElementById('chatMessages');
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        // Xá»­ lÃ½ thay Ä‘á»•i ngÃ´n ngá»¯
        document.getElementById('languageSelect').addEventListener('change', function(e) {
            currentLanguage = e.target.value;
            updateLanguage();
        });

        function updateLanguage() {
            const translations = {
                vi: {
                    welcome: "ğŸ‘‹ Xin chÃ o! TÃ´i lÃ  AI Assistant cá»§a phÃ²ng CÆ¡ Äiá»‡n...",
                    placeholder: "Nháº­p cÃ¢u há»i cá»§a báº¡n...",
                    sendButton: "ğŸ“¤ Gá»­i"
                },
                en: {
                    welcome: "ğŸ‘‹ Hello! I'm the AI Assistant for the Mechanical-Electrical Department...",
                    placeholder: "Enter your question...",
                    sendButton: "ğŸ“¤ Send"
                },
                zh: {
                    welcome: "ğŸ‘‹ æ‚¨å¥½ï¼æˆ‘æ˜¯æœºç”µéƒ¨é—¨çš„AIåŠ©æ‰‹...",
                    placeholder: "è¾“å…¥æ‚¨çš„é—®é¢˜...",
                    sendButton: "ğŸ“¤ å‘é€"
                }
            };
            
            const lang = translations[currentLanguage] || translations.vi;
            document.getElementById('chatInput').placeholder = lang.placeholder;
            document.getElementById('sendButton').textContent = lang.sendButton;
        }

        // Xá»­ lÃ½ upload file (má»Ÿ rá»™ng trong tÆ°Æ¡ng lai)
        function handleFileUpload() {
            // Sáº½ Ä‘Æ°á»£c triá»ƒn khai Ä‘á»ƒ upload trá»±c tiáº¿p lÃªn Google Drive API
            alert('TÃ­nh nÄƒng nÃ y sáº½ Ä‘Æ°á»£c phÃ¡t triá»ƒn Ä‘á»ƒ tÃ­ch há»£p vá»›i Google Drive API');
        }

        // Auto-save conversation (tÃ¹y chá»n)
        function saveConversation() {
            const messages = Array.from(document.querySelectorAll('.message')).map(msg => ({
                content: msg.textContent,
                type: msg.className.includes('user-message') ? 'user' : 'ai',
                timestamp: new Date().toISOString()
            }));
            
            // LÆ°u vÃ o localStorage hoáº·c gá»­i lÃªn server
            console.log('Conversation saved:', messages);
        }
    </script>
</body>
</html>